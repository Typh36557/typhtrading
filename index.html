<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>TYPH SIGNAL TRADING</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; background:#0f172a; color:#fff; text-align:center; padding:20px }
.box { background:#020617; padding:20px; border-radius:10px; max-width:420px; margin:auto }
.call { color:#22c55e; font-size:40px; font-weight:bold }
.put { color:#ef4444; font-size:40px; font-weight:bold }
.wait { background:#facc15; color:#000; padding:6px 12px; border-radius:6px; font-weight:bold }
.enter { background:#22c55e; padding:6px 12px; border-radius:6px; font-weight:bold }
.news { background:#1e293b; padding:10px; margin:10px auto; border-radius:8px }
.history { text-align:left; margin-top:20px }
a.btn { display:inline-block; margin-top:10px; padding:10px 16px; background:#229ED9; color:#fff; border-radius:8px; text-decoration:none }
</style>
</head>
<body>

<h1>ðŸ“Š TYPH SIGNAL TRADING</h1>
<div class="news" id="news"></div>

<div class="box">
  <div id="type"></div>
  <h2 id="actif">--</h2>
  <div id="etat"></div>
  <p id="heure"></p>
  <p id="expiration"></p>
  <p id="commentaire"></p>
</div>

<a id="facebook" class="btn" target="_blank">ðŸ“˜ Groupe Facebook Formations</a>

<div class="history">
  <h3>ðŸ“œ Historique</h3>
  <ul id="history"></ul>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getDatabase, ref, onValue, push } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBYTj0oxyGyYMGuG3oS3I9rsJztkKI19cQ",
  authDomain: "signal-trading-dc7e1.firebaseapp.com",
  databaseURL: "https://signal-trading-dc7e1-default-rtdb.firebaseio.com",
  projectId: "signal-trading-dc7e1",
  storageBucket: "signal-trading-dc7e1.firebasestorage.app",
  messagingSenderId: "1079678337192",
  appId: "1:1079678337192:web:0ae573263a9772acb9029d",
  measurementId: "G-MM3GRDYVLX"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// SIGNAL ACTUEL
onValue(ref(db, "currentSignal"), (snap) => {
  const s = snap.val();
  if (!s) return;

  document.getElementById("type").innerHTML =
    `<div class="${s.type === 'CALL' ? 'call' : 'put'}">${s.type}</div>`;
  document.getElementById("actif").innerText = s.actif;
  document.getElementById("etat").innerHTML =
    s.etat === "ATTENDRE" ? `<span class="wait">ATTENDRE</span>` : `<span class="enter">ENTRER</span>`;
  document.getElementById("heure").innerText = "EntrÃ©e : " + s.heure;
  document.getElementById("expiration").innerText = "Expiration : " + s.expiration;
  document.getElementById("commentaire").innerText = s.commentaire;

  // AJOUTER AU HISTORIQUE AUTOMATIQUEMENT
  push(ref(db, "history"), {
    actif: s.actif,
    type: s.type,
    etat: s.etat,
    heure: s.heure,
    expiration: s.expiration,
    commentaire: s.commentaire,
    timestamp: Date.now()
  });
});

// NEWS
onValue(ref(db, "news"), (snap) => {
  document.getElementById("news").innerText = snap.val() || "";
});

// FACEBOOK
onValue(ref(db, "facebook"), (snap) => {
  document.getElementById("facebook").href = snap.val() || "#";
});

// HISTORIQUE
onValue(ref(db, "history"), (snap) => {
  const list = document.getElementById("history");
  list.innerHTML = "";
  snap.forEach(item => {
    const s = item.val();
    const li = document.createElement("li");
    li.innerText = `${s.actif} ${s.type} - ${s.etat} - ${s.heure}`;
    list.prepend(li);
  });
});
</script>
</body>
</html>
